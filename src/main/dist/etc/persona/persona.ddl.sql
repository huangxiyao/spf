CREATE TABLE APP
(
	APP_PRTFL_ID          INTEGER  NOT NULL ,
	CRT_USER_ID           VARCHAR(140)   DEFAULT  '' NOT NULL ,
	CRT_TS                TIMESTAMP   DEFAULT  CURRENT_TIMESTAMP NOT NULL ,
	LAST_MAINT_USER_ID    VARCHAR(140)   DEFAULT  '' NOT NULL ,
	LAST_MAINT_TS         TIMESTAMP   DEFAULT  CURRENT_TIMESTAMP NOT NULL ,
	SRC_SYS_CRT_USER_ID   VARCHAR(140)   DEFAULT  '' NOT NULL ,
	SRC_SYS_CRT_TS        TIMESTAMP   DEFAULT  CURRENT_TIMESTAMP NOT NULL ,
	SRC_SYS_MAINT_USER_ID  VARCHAR(140)   DEFAULT  '' NOT NULL ,
	SRC_SYS_MAINT_TS      TIMESTAMP   DEFAULT  CURRENT_TIMESTAMP NOT NULL ,
	APP_CI_ID             VARCHAR(255)   DEFAULT  '' NOT NULL ,
	APP_ALIAS_NM          VARCHAR(60)   DEFAULT  '' NOT NULL ,
	APP_DN                VARCHAR(255)   DEFAULT  '' NOT NULL 
);



CREATE UNIQUE INDEX PK_APP ON APP
(APP_PRTFL_ID  ASC);



ALTER TABLE APP
	ADD CONSTRAINT  PK_APP PRIMARY KEY (APP_PRTFL_ID);



CREATE TABLE APP_DIAG_LOG
(
	EVNT_TS               TIMESTAMP  NOT NULL ,
	APP_DIAG_LOG_KY       INTEGER  NOT NULL ,
	CRT_USER_ID           VARCHAR(140)   DEFAULT  '' NOT NULL ,
	CRT_TS                TIMESTAMP   DEFAULT  CURRENT_TIMESTAMP NOT NULL ,
	MOD_CLS_NM            VARCHAR(60)   DEFAULT  '' NOT NULL ,
	EVNT_SEVR_CD          VARCHAR(10)   DEFAULT  '' NOT NULL ,
	MSG_ID                VARCHAR(20)   DEFAULT  '' NOT NULL ,
	RUN_ENVRMT_TYPE_CD    VARCHAR(10)   DEFAULT  '' NOT NULL ,
	APP_PRTFL_ID          INTEGER   DEFAULT  0 NOT NULL ,
	SRVR_GRP_ID           VARCHAR(20)   DEFAULT  '' NOT NULL ,
	SRVR_CI_ID            VARCHAR(255)   DEFAULT  '' NOT NULL ,
	EVNT_EXCPN_DTL_TX     CLOB   DEFAULT  ' ' NOT NULL 
);



CREATE UNIQUE INDEX PK_APP_DIAG_LOG ON APP_DIAG_LOG
(EVNT_TS  ASC,APP_DIAG_LOG_KY  ASC);



ALTER TABLE APP_DIAG_LOG
	ADD CONSTRAINT  PK_APP_DIAG_LOG PRIMARY KEY (EVNT_TS,APP_DIAG_LOG_KY);



CREATE TABLE APP_SYS_PARM
(
	APP_PRTFL_ID          INTEGER  NOT NULL ,
	PARM_NM               VARCHAR(60)  NOT NULL ,
	SEQ_NR                SMALLINT  NOT NULL ,
	CRT_USER_ID           VARCHAR(140)   DEFAULT  '' NOT NULL ,
	CRT_TS                TIMESTAMP   DEFAULT  CURRENT_TIMESTAMP NOT NULL ,
	LAST_UPD_USER_ID      VARCHAR(140)   DEFAULT  '' NOT NULL ,
	LAST_UPD_TS           TIMESTAMP,
	DCML_PARM_VALU_NR     DOUBLE,
	INTG_PARM_VALU_NR     INTEGER,
	PARM_VALU_DT          TIMESTAMP,
	PARM_VALU_TM          TIMESTAMP,
	PARM_VALU_TS          TIMESTAMP,
	PARM_VALU_TX          VARCHAR(255) 
);



CREATE UNIQUE INDEX PK_APP_SYS_PARM ON APP_SYS_PARM
(APP_PRTFL_ID  ASC,PARM_NM  ASC,SEQ_NR  ASC);



ALTER TABLE APP_SYS_PARM
	ADD CONSTRAINT  PK_APP_SYS_PARM PRIMARY KEY (APP_PRTFL_ID,PARM_NM,SEQ_NR);


CREATE TABLE APP_CMPND_ATTR_SMPL_ATTR_PRMSN
(
	APP_PRTFL_ID          INTEGER  NOT NULL ,
	CMPND_USER_ATTR_ID    VARCHAR(30)  NOT NULL ,
	SMPL_USER_ATTR_ID     VARCHAR(30)  NOT NULL ,
	CRT_USER_ID           VARCHAR(140)   DEFAULT  ' ' NOT NULL ,
	CRT_TS                TIMESTAMP   DEFAULT  CURRENT_TIMESTAMP NOT NULL 
);



CREATE UNIQUE INDEX PK_APP_CMPND_ATTR_SMPL_ATTR_PR ON APP_CMPND_ATTR_SMPL_ATTR_PRMSN
(APP_PRTFL_ID  ASC,CMPND_USER_ATTR_ID  ASC,SMPL_USER_ATTR_ID  ASC);



ALTER TABLE APP_CMPND_ATTR_SMPL_ATTR_PRMSN
	ADD CONSTRAINT  PK_APP_CMPND_ATTR_SMPL_ATTR_PR PRIMARY KEY (APP_PRTFL_ID,CMPND_USER_ATTR_ID,SMPL_USER_ATTR_ID);



CREATE INDEX IE1_APP_CMPND_ATTR_SMPL_ATTR_P ON APP_CMPND_ATTR_SMPL_ATTR_PRMSN
(CMPND_USER_ATTR_ID  ASC,SMPL_USER_ATTR_ID  ASC);



CREATE TABLE APP_USER_ATTR_PRMSN
(
	APP_PRTFL_ID          INTEGER  NOT NULL ,
	USER_ATTR_ID          VARCHAR(30)  NOT NULL ,
	CRT_USER_ID           VARCHAR(140)   DEFAULT  ' ' NOT NULL ,
	CRT_TS                TIMESTAMP   DEFAULT  CURRENT_TIMESTAMP NOT NULL 
);



CREATE UNIQUE INDEX PK_APP_USER_ATTR_PRMSN ON APP_USER_ATTR_PRMSN
(APP_PRTFL_ID  ASC,USER_ATTR_ID  ASC);



ALTER TABLE APP_USER_ATTR_PRMSN
	ADD CONSTRAINT  PK_APP_USER_ATTR_PRMSN PRIMARY KEY (APP_PRTFL_ID,USER_ATTR_ID);



CREATE INDEX IE1_APP_USER_ATTR_PRMSN ON APP_USER_ATTR_PRMSN
(USER_ATTR_ID  ASC);



CREATE TABLE CMPND_ATTR_SMPL_ATTR
(
	CMPND_USER_ATTR_ID    VARCHAR(30)  NOT NULL ,
	SMPL_USER_ATTR_ID     VARCHAR(30)  NOT NULL ,
	CRT_USER_ID           VARCHAR(140)   DEFAULT  ' ' NOT NULL ,
	CRT_TS                TIMESTAMP   DEFAULT  CURRENT_TIMESTAMP NOT NULL 
);



CREATE UNIQUE INDEX PK_CMPND_ATTR_SMPL_ATTR ON CMPND_ATTR_SMPL_ATTR
(CMPND_USER_ATTR_ID  ASC,SMPL_USER_ATTR_ID  ASC);



ALTER TABLE CMPND_ATTR_SMPL_ATTR
	ADD CONSTRAINT  PK_CMPND_ATTR_SMPL_ATTR PRIMARY KEY (CMPND_USER_ATTR_ID,SMPL_USER_ATTR_ID);



CREATE INDEX IE1_CMPND_ATTR_SMPL_ATTR ON CMPND_ATTR_SMPL_ATTR
(SMPL_USER_ATTR_ID  ASC);



CREATE TABLE USER_ATTR
(
	USER_ATTR_ID          VARCHAR(30)  NOT NULL ,
	CRT_USER_ID           VARCHAR(140)   DEFAULT  ' ' NOT NULL ,
	CRT_TS                TIMESTAMP   DEFAULT  CURRENT_TIMESTAMP NOT NULL ,
	LAST_MAINT_USER_ID    VARCHAR(140)   DEFAULT  ' ' NOT NULL ,
	LAST_MAINT_TS         TIMESTAMP   DEFAULT  CURRENT_TIMESTAMP NOT NULL ,
	USER_ATTR_TYPE_CD     VARCHAR(10)   DEFAULT  ' ' NOT NULL ,
	USER_ATTR_NM          VARCHAR(60)   DEFAULT  ' ' NOT NULL ,
	USER_ATTR_DN          VARCHAR(255)   DEFAULT  ' ' NOT NULL ,
	USER_ATTR_DEFN_TX     CLOB DEFAULT ' ' NOT NULL
);



CREATE UNIQUE INDEX PK_USER_ATTR ON USER_ATTR
(USER_ATTR_ID  ASC);



ALTER TABLE USER_ATTR
	ADD CONSTRAINT  PK_USER_ATTR PRIMARY KEY (USER_ATTR_ID);



CREATE UNIQUE INDEX AK1_USER_ATTR ON USER_ATTR
(USER_ATTR_NM  ASC);



CREATE INDEX IE1_USER_ATTR ON USER_ATTR
(USER_ATTR_TYPE_CD  ASC);



CREATE TABLE USER_ATTR_TYPE
(
	USER_ATTR_TYPE_CD     VARCHAR(10)  NOT NULL ,
	CRT_USER_ID           VARCHAR(140)   DEFAULT  ' ' NOT NULL ,
	CRT_TS                TIMESTAMP   DEFAULT  CURRENT_TIMESTAMP NOT NULL ,
	LAST_MAINT_USER_ID    VARCHAR(140)   DEFAULT  ' ' NOT NULL ,
	LAST_MAINT_TS         TIMESTAMP   DEFAULT  CURRENT_TIMESTAMP NOT NULL ,
	USER_ATTR_TYPE_NM     VARCHAR(60)   DEFAULT  ' ' NOT NULL ,
	USER_ATTR_TYPE_DN     VARCHAR(255)   DEFAULT  ' ' NOT NULL 
);



CREATE UNIQUE INDEX PK_USER_ATTR_TYPE ON USER_ATTR_TYPE
(USER_ATTR_TYPE_CD  ASC);



ALTER TABLE USER_ATTR_TYPE
	ADD CONSTRAINT  PK_USER_ATTR_TYPE PRIMARY KEY (USER_ATTR_TYPE_CD);



CREATE TABLE USER_ATTR_VALU
(
	USER_ID               VARCHAR(140)  NOT NULL ,
	USER_ID_TYPE_CD       VARCHAR(10)  NOT NULL ,
	CMPND_USER_ATTR_ID    VARCHAR(30)  NOT NULL ,
	SMPL_USER_ATTR_ID     VARCHAR(30)  NOT NULL ,
	USER_ATTR_INSTNC_ID   CHAR(36)  NOT NULL ,
	CRT_USER_ID           VARCHAR(140)   DEFAULT  ' ' NOT NULL ,
	CRT_TS                TIMESTAMP   DEFAULT  CURRENT_TIMESTAMP NOT NULL ,
	LAST_MAINT_USER_ID    VARCHAR(140)   DEFAULT  ' ' NOT NULL ,
	LAST_MAINT_TS         TIMESTAMP   DEFAULT  CURRENT_TIMESTAMP NOT NULL ,
	USER_ATTR_VALU_TX     VARCHAR(255)   DEFAULT  ' ' NOT NULL 
);



CREATE UNIQUE INDEX PK_USER_ATTR_VALU ON USER_ATTR_VALU
(USER_ID  ASC,USER_ID_TYPE_CD  ASC,CMPND_USER_ATTR_ID  ASC,SMPL_USER_ATTR_ID  ASC,USER_ATTR_INSTNC_ID  ASC);



ALTER TABLE USER_ATTR_VALU
	ADD CONSTRAINT  PK_USER_ATTR_VALU PRIMARY KEY (USER_ID,USER_ID_TYPE_CD,CMPND_USER_ATTR_ID,SMPL_USER_ATTR_ID,USER_ATTR_INSTNC_ID);



CREATE INDEX IE1_USER_ATTR_VALU ON USER_ATTR_VALU
(CMPND_USER_ATTR_ID  ASC,SMPL_USER_ATTR_ID  ASC,USER_ATTR_VALU_TX  ASC);



CREATE TABLE USER_ID_TYPE
(
	USER_ID_TYPE_CD       VARCHAR(10)  NOT NULL ,
	CRT_USER_ID           VARCHAR(140)   DEFAULT  ' ' NOT NULL ,
	CRT_TS                TIMESTAMP   DEFAULT  CURRENT_TIMESTAMP NOT NULL ,
	LAST_MAINT_USER_ID    VARCHAR(140)   DEFAULT  ' ' NOT NULL ,
	LAST_MAINT_TS         TIMESTAMP   DEFAULT  CURRENT_TIMESTAMP NOT NULL ,
	USER_ID_TYPE_NM       VARCHAR(60)   DEFAULT  ' ' NOT NULL ,
	USER_ID_TYPE_DN       VARCHAR(255)   DEFAULT  ' ' NOT NULL 
);



CREATE UNIQUE INDEX PK_USER_ID_TYPE ON USER_ID_TYPE
(USER_ID_TYPE_CD  ASC);



ALTER TABLE USER_ID_TYPE
	ADD CONSTRAINT  PK_USER_ID_TYPE PRIMARY KEY (USER_ID_TYPE_CD);





INSERT
INTO user_attr_type (user_attr_type_cd, user_attr_type_nm, user_attr_type_dn, crt_user_id, last_maint_user_id)
VALUES ('SMPL', 'Simple user attribute', 'A simple user attribute names a string value.', 'quintin.may@hp.com', 'quintin.may@hp.com');

INSERT
INTO user_attr_type (user_attr_type_cd, user_attr_type_nm, user_attr_type_dn, crt_user_id, last_maint_user_id)
VALUES ('CMPND', 'Compound user attribute', 'A compound user attribute names an associative structure (map). The map structure is composed of simple attributes and values.', 'quintin.may@hp.com', 'quintin.may@hp.com');

INSERT
INTO user_id_type (user_id_type_cd, user_id_type_nm, user_id_type_dn, crt_user_id, last_maint_user_id)
VALUES ('EXT', 'An HP Passport user identifier.', 'An HP Passport user identifier.', 'quintin.may@hp.com', 'quintin.may@hp.com');

INSERT
INTO user_id_type (user_id_type_cd, user_id_type_nm, user_id_type_dn, crt_user_id, last_maint_user_id)
VALUES ('EMP', 'An HP employee number.', 'An HP employee number.', 'quintin.may@hp.com', 'quintin.may@hp.com');

INSERT
INTO user_id_type (user_id_type_cd, user_id_type_nm, user_id_type_dn, crt_user_id, last_maint_user_id)
VALUES ('EMP_SEA', 'An HP employee simplified email address.', 'An HP employee simplified email address.', 'quintin.may@hp.com', 'quintin.may@hp.com');

INSERT
INTO app (app_prtfl_id, app_ci_id, app_alias_nm, app_dn, crt_user_id, last_maint_user_id, src_sys_crt_user_id, src_sys_maint_user_id)
VALUES (116414, 'hpit:spf', 'SPF', 'Shared Portal Framework', 'quintin.may@hp.com', 'quintin.may@hp.com', 'quintin.may@hp.com', 'quintin.may@hp.com');

--commit;

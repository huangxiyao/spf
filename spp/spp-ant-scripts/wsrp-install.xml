<project name="build-spp" default="all" basedir=".">
 	
	<!--=======================================================================
		Set the base build,source and backup directories
	=======================================================================-->	

 	
	<property name="dir.build" value=".\build"/>
	<property name="dir.src" value="/opt/spp/SPP-Source"/>
	<property name="dest.dir" value="/opt/spp/bea/user_projects/domains/sppdomain/applications"/>
	<property name="backup.dir" value="/tmp/spp-backup"/>


	<!--=======================================================================
		Backup the Existing Application
	=======================================================================-->	

	
	<target name="backup-existing" description="Creates a backup tar of the existing application">
		<echo message="Creating backup of existing application" />
			<tstamp>
				<format property="startDateTime" pattern="MMddyyyyhhmm"/>
		    </tstamp>
			<tar tarfile="${backup.dir}\spp_services_web_${startDateTime}.tar" basedir="${dest.dir}\spp-services-web"/>
	</target>


	<!--=======================================================================
		Delete the Existing Application
	=======================================================================-->	


	<target name="delete-existing-application" description="Delete Existing Application">
		<echo message="Delete the Existing Application: ${dest.dir}"/>
		<delete dir="\${dest.dir}\spp-services-web"/>
	</target>

	
 	<!--=======================================================================
			Create the Required Directories
	=======================================================================-->	
 	
 	
	<target name="make-dir" description="Creates all required new directories"> 		
 		<echo message="Creating Build directory"/>
		<mkdir dir="${dir.build}"/>
		<echo message="Creating spp-services-web directory"/>
		<mkdir dir="${dir.build}/spp-services-web/spp-services-web"/>
	</target>

 	
	<!--=======================================================================
					Copy spp-services-web	
	=======================================================================-->	
 	
 	
	<target name="copy-spp-services-web" description="Copy spp-services-web.war">
 		<echo message="Copying spp-services-web"/>
		<copy todir="${dir.build}/spp-services-web/spp-services-web">
			<fileset dir="${dir.src}">
				    <include name="spp-services-web.war"/>
			</fileset>
		</copy>
 	</target> 	

 	
	<!--=======================================================================
			Explode the war files
	=======================================================================-->	
	
 	
	<target name="explode-spp-services-web" description="Explode spp-spp-services-web.war">
		<echo message="Exploding spp-services-web"/>
		<unwar 	src="${dir.build}/spp-services-web/spp-services-web/spp-services-web.war"
			dest="${dir.build}/spp-services-web/spp-services-web" />		
 	</target> 	

 		
	<!--=======================================================================
			Delete the war files
	=======================================================================-->	
	
	
	<target name="delete-spp-services-web" description="Delete spp-spp-portal-web.war">
		<echo message="Deleting spp-services-web"/>
		<delete	file="${dir.build}/spp-services-web/spp-services-web/spp-services-web.war" />				
 	</target>

 	
	<!--=======================================================================
			Copy the files to the Servers
	=======================================================================-->	
		
	
	<target name="copy-to-server-spp-services-web" description="Copy spp-services-web">
		<echo message="Copying spp-services-web to the Server"/>
		<copy todir="${dest.dir}">
			 <fileset dir="${dir.build}/spp-services-web"/>
		</copy>
 	</target> 	

 	
	<!--=======================================================================
			Delete the Directories created by the script
	=======================================================================-->	
	
	
	<target name="delete-build-directory" description="Delete created Delete Directory">
		<echo message="Delete the Build directory created by the script"/>
		<delete dir="${dir.build}\spp-services-web"/>
	</target>


	
 	<!--=======================================================================
				Targets to be executed
				
	=======================================================================-->	
 	
	
	<target name="all" description="Executing all the steps One by One"
		depends="
			backup-existing,
			delete-existing-application,
			make-dir,
			copy-spp-services-web,
			explode-spp-services-web,
			delete-spp-services-web,
			copy-to-server-spp-services-web,
			delete-build-directory			
			"
		/>	
	
</project>